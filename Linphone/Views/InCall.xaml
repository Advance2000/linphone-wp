<linphone:BasePage
    x:Class="Linphone.Views.InCall"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:linphone="clr-namespace:Linphone"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    mc:Ignorable="d"
    shell:SystemTray.IsVisible="True">

    <phone:PhoneApplicationPage.Resources>
        <Style TargetType="Button" x:Key="AccentButton">
            
        </Style>
    </phone:PhoneApplicationPage.Resources>
    
    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid
        x:Name="LayoutRoot"
        Background="Transparent"
        Tap="LayoutRoot_Tap">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="emptyPanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock Style="{StaticResource PhoneTextNormalStyle}"/>
        </StackPanel>

        <StackPanel x:Name="statsPanel" Grid.Row="1" Margin="12,17,0,28" Visibility="Collapsed">
            <Grid Grid.Row="1" Margin="0,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="AudioStats" Text="{Binding Path=LocalizedResources.AudioStatsMenu, Source={StaticResource LocalizedStrings}}" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="0" Grid.Row="0"/>
                <TextBlock x:Name="AudioDownBw" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="0" Grid.Row="1"/>
                <TextBlock x:Name="AudioUpBw" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="0" Grid.Row="2"/>
                <TextBlock x:Name="AudioPType" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="0" Grid.Row="3"/>
                <TextBlock x:Name="VideoStats" Text="{Binding Path=LocalizedResources.VideoStatsMenu, Source={StaticResource LocalizedStrings}}" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="1" Grid.Row="0" Visibility="Collapsed"/>
                <TextBlock x:Name="VideoDownBw" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="1" Grid.Row="1"/>
                <TextBlock x:Name="VideoUpBw" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="1" Grid.Row="2"/>
                <TextBlock x:Name="VideoPType" Style="{StaticResource PhoneTextNormalStyle}" Grid.Column="1" Grid.Row="3"/>
            </Grid>
        </StackPanel>

        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="*"></RowDefinition>
            </Grid.RowDefinitions>
            
            <TextBlock
                Grid.Row="0"
                x:Name="Status"
                Style="{StaticResource PhoneTextAccentStyle}"
                Text="{Binding Path=LocalizedResources.Dialing, Source={StaticResource LocalizedStrings}}"
                Margin="12,0,12,0"
                FontSize="20" />
            
            <TextBlock
                Grid.Row="1"
                x:Name="Contact"
                Margin="12,0,12,0"
                FontSize="60"/>

            <TextBlock
                Grid.Row="2"
                x:Name="Number"
                Margin="12,0,12,0"
                FontSize="25"/>
            
            <Grid
                x:Name="buttons"
                Grid.Row="3"
                Margin="0,25,0,0"
                Opacity="{Binding ButtonsOpacity}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid.Resources>
                    <Storyboard x:Name="ButtonsFadeOutAnimation">
                        <DoubleAnimation
                            Storyboard.TargetName="buttons"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.0"
                            Completed="ButtonsFadeOutAnimation_Completed"/>
                        <DoubleAnimation
                            Storyboard.TargetName="statsPanel"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Status"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Contact"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Number"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.0"/>
                    </Storyboard>
                    <Storyboard x:Name="ButtonsFadeInAnimation">
                        <DoubleAnimation
                            Storyboard.TargetName="buttons"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="0.7"/>
                        <DoubleAnimation
                            Storyboard.TargetName="statsPanel"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="1.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Status"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="1.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Contact"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="1.0"/>
                        <DoubleAnimation
                            Storyboard.TargetName="Number"
                            Storyboard.TargetProperty="(Opacity)"
                            Duration="0:0:0.5"
                            To="1.0"/>
                    </Storyboard>
                </Grid.Resources>

                <Button 
                    x:Name="hangUp"
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    BorderThickness="0"
                    Margin="-10"
                    Background="{StaticResource PhoneAccentBrush}"
                    Content="{Binding Path=LocalizedResources.HangUp, Source={StaticResource LocalizedStrings}}"
                    Click="hangUp_Click"
                    ClickMode="Release">
                    <Button.Style>
                        <StaticResource ResourceKey="AccentColorButton"/>
                    </Button.Style>
                </Button>

                <ToggleButton 
                    x:Name="dialpad"
                    Grid.Row="0"
                    Grid.Column="2"
                    BorderThickness="0"
                    Margin="-10"
                    Click="dialpad_Click_1"
                    Background="{StaticResource PhoneChromeBrush}"
                    IsChecked="{Binding IsDialpadToggled}">
                    <StackPanel Orientation="Vertical">
                        <Image Source="/Assets/AppBar/dialpad.png" Stretch="None"/>
                    </StackPanel>
                </ToggleButton>

                <ToggleButton 
                    x:Name="speaker"
                    Grid.Row="1"
                    Grid.Column="0"
                    BorderThickness="0"
                    Margin="-10"
                    Click="speaker_Click_1"
                    Visibility="{Binding SpeakerButtonVisibility}"
                    Background="{StaticResource PhoneChromeBrush}">
                    <StackPanel Orientation="Vertical">
                        <Image x:Name="speakerImg" Source="/Assets/AppBar/speaker.png" Stretch="None"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="20" Text="{Binding Path=LocalizedResources.Speaker, Source={StaticResource LocalizedStrings}}" TextWrapping="Wrap" Margin="5,0,5,10"/>
                    </StackPanel>
                </ToggleButton>

                <ToggleButton 
                    x:Name="microphone"
                    Grid.Row="1"
                    Grid.Column="1"
                    BorderThickness="0"
                    Margin="-10"
                    Click="microphone_Click_1"
                    Visibility="{Binding MicrophoneButtonVisibility}"
                    Background="{StaticResource PhoneChromeBrush}">
                    <StackPanel Orientation="Vertical">
                        <Image x:Name="microImg" Source="/Assets/AppBar/mic.png" Stretch="None"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="20" Text="{Binding Path=LocalizedResources.Mute, Source={StaticResource LocalizedStrings}}" TextWrapping="Wrap"  Margin="5,0,5,10"/>
                    </StackPanel>
                </ToggleButton>

                <ToggleButton
                    x:Name="pause"
                    Grid.Row="1"
                    Grid.Column="2"
                    BorderThickness="0"
                    Margin="-10"
                    Click="pause_Click_1"
                    Visibility="{Binding PauseButtonVisibility}"
                    Background="{StaticResource PhoneChromeBrush}">
                    <StackPanel Orientation="Vertical">
                        <Image x:Name="pauseImg" Source="/Assets/AppBar/pause.png" Stretch="None"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="20" Text="{Binding Path=LocalizedResources.Hold, Source={StaticResource LocalizedStrings}}" TextWrapping="Wrap"  Margin="5,0,5,10"/>
                    </StackPanel>
                </ToggleButton>
                
                <ToggleButton 
                    x:Name="stats"
                    Grid.Row="2"
                    Grid.Column="0"
                    BorderThickness="0"
                    Margin="-10"
                    Click="stats_Click_1"
                    Visibility="{Binding StatsButtonVisibility}"
                    Background="{StaticResource PhoneChromeBrush}">
                    <StackPanel Orientation="Vertical">
                        <Image x:Name="statsImg" Source="/Assets/AppBar/stats.png" Stretch="None"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="20" Text="{Binding Path=LocalizedResources.Stats, Source={StaticResource LocalizedStrings}}" TextWrapping="Wrap"  Margin="5,0,5,10"/>
                    </StackPanel>
                </ToggleButton>

                <Grid
                    x:Name="numpad"
                    Grid.Row="3"
                    Grid.ColumnSpan="3"
                    Visibility="{Binding NumpadVisibility}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Button
                        Grid.Row="0"
                        Grid.Column="0"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="1"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="1" FontSize="30"/>
                            <TextBlock Text="         " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>    
                    </Button>

                    <Button
                        Grid.Row="0"
                        Grid.Column="1"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="2"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="2" FontSize="30"/>
                            <TextBlock Text="ABC" FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="0"
                        Grid.Column="2"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="3"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="3" FontSize="30"/>
                            <TextBlock Text="DEF   " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="1"
                        Grid.Column="0"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="4"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="4" FontSize="30"/>
                            <TextBlock Text="GHI   " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="1"
                        Grid.Column="1"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="5"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="5" FontSize="30"/>
                            <TextBlock Text="JKL  " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="1"
                        Grid.Column="2"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="6"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="6" FontSize="30"/>
                            <TextBlock Text="MNO " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="2"
                        Grid.Column="0"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="7"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="7" FontSize="30"/>
                            <TextBlock Text="PQRS" FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="2"
                        Grid.Column="1"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="8"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="8" FontSize="30"/>
                            <TextBlock Text="TUV " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="2"
                        Grid.Column="2"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="9"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="9" FontSize="30"/>
                            <TextBlock Text="WXYZ" FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="3"
                        Grid.Column="0"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="*"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="＊" FontSize="30"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="3"
                        Grid.Column="1"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="0"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="0" FontSize="30"/>
                            <TextBlock Text="        " FontSize="20" Foreground="Gray" Margin="10,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Grid.Row="3"
                        Grid.Column="2"
                        BorderThickness="0"
                        Margin="-10"
                        Click="Numpad_Click_1"
                        Tag="#"
                        Background="{StaticResource PhoneChromeBrush}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="#" FontSize="30"/>
                        </StackPanel>
                    </Button>

                </Grid>

            </Grid>
        </Grid>

        <Grid Grid.RowSpan="3" Canvas.ZIndex="-2">
            <MediaElement
                x:Name="remoteVideo"
                Visibility="{Binding RemoteVideoVisibility}"
                MediaOpened="remoteVideo_MediaOpened_1"
                MediaFailed="remoteVideo_MediaFailed_1"
                Source="{Binding RemoteVideoUri}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform"/>
        </Grid>
        
        <Grid Grid.RowSpan="3" Canvas.ZIndex="-1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <MediaElement
                x:Name="localVideo"
                Grid.Row="3"
                Grid.Column="2"
                Margin="5"
                Visibility="{Binding LocalVideoVisibility}"
                MediaOpened="localVideo_MediaOpened_1"
                MediaFailed="localVideo_MediaFailed_1"
                Source="{Binding LocalVideoUri}"
                RenderTransformOrigin="0.5,0.5"
                Stretch="Uniform">
                <MediaElement.RenderTransform>
                    <CompositeTransform Rotation="{Binding LocalVideoRotation}"/>
                </MediaElement.RenderTransform>
            </MediaElement>
        </Grid>

    </Grid>

</linphone:BasePage>